<!-- Adicionado pt-24 para compensar a navbar global fixa -->
<div class="bg-gray-50 min-h-screen font-sans text-gray-900 pb-20 pt-24">
  <!-- Navbar local removida conforme solicitado -->

  <main class="max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in">
    <div class="flex flex-col lg:flex-row gap-10">
      <!-- COLUNA DA ESQUERDA: Galeria -->
      <div class="w-full lg:w-[65%]">
        <!-- Visualizador Principal -->
        <div
          class="relative bg-white rounded-3xl shadow-sm border border-gray-200 overflow-hidden aspect-[16/10] group"
        >
          <!-- Modo 3D -->
          <div *ngIf="is3DActive" class="absolute inset-0 bg-gray-100 z-20 animate-fade-in">
            <model-viewer
              [src]="car.model3d"
              alt="Visualização 3D Detalhada"
              camera-orbit="45deg 75deg 100%"
              field-of-view="25deg"
              auto-rotate
              rotation-per-second="5deg"
              camera-controls
              shadow-intensity="1"
              class="w-full h-full focus:outline-none"
              style="--poster-color: transparent; background-color: #f3f4f6"
            ></model-viewer>

            <div
              class="absolute bottom-6 left-1/2 -translate-x-1/2 bg-white/90 backdrop-blur px-4 py-2 rounded-full shadow-sm text-xs font-bold text-gray-600 flex items-center gap-2 pointer-events-none"
            >
              <i data-lucide="hand-metal" class="w-4 h-4 text-red-600"></i>
              Arraste para girar e ampliar
            </div>
          </div>

          <!-- Modo Imagem -->
          <img
            *ngIf="!is3DActive"
            [src]="car.images[currentImageIndex]"
            class="w-full h-full object-cover transition-transform duration-700 hover:scale-105 cursor-zoom-in"
            alt="Foto do veículo"
          />

          <!-- Botão Alternar 3D/2D -->
          <button
            *ngIf="car.model3d"
            (click)="toggle3D()"
            class="absolute top-6 right-6 bg-white hover:bg-red-600 hover:text-white text-gray-900 px-5 py-2.5 rounded-full shadow-lg transition-all z-30 flex items-center gap-2 text-xs font-bold uppercase tracking-widest border border-gray-100 group/btn"
          >
            <i [attr.data-lucide]="is3DActive ? 'image' : 'box'" class="w-4 h-4"></i>
            {{ is3DActive ? 'Ver Fotos' : 'Ver em 3D' }}
          </button>

          <!-- Navegação da Galeria (Setas) -->
          <div
            *ngIf="!is3DActive"
            class="absolute inset-x-4 top-1/2 -translate-y-1/2 flex justify-between pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity duration-300"
          >
            <button
              (click)="prevImage()"
              class="pointer-events-auto w-12 h-12 bg-white/90 hover:bg-white rounded-full shadow-lg flex items-center justify-center text-gray-800 transition-transform hover:scale-110 active:scale-95"
            >
              <i data-lucide="chevron-left" class="w-6 h-6"></i>
            </button>
            <button
              (click)="nextImage()"
              class="pointer-events-auto w-12 h-12 bg-white/90 hover:bg-white rounded-full shadow-lg flex items-center justify-center text-gray-800 transition-transform hover:scale-110 active:scale-95"
            >
              <i data-lucide="chevron-right" class="w-6 h-6"></i>
            </button>
          </div>
        </div>

        <!-- Thumbnails -->
        <div class="flex gap-3 mt-4 overflow-x-auto pb-2 custom-scrollbar">
          <!-- Botão Thumbnail 3D -->
          <button
            *ngIf="car.model3d"
            (click)="is3DActive = true"
            class="flex-shrink-0 w-24 h-20 rounded-xl overflow-hidden border-2 transition-all relative group"
            [class.border-red-600]="is3DActive"
            [class.border-transparent]="!is3DActive"
          >
            <div
              class="absolute inset-0 bg-gray-100 flex flex-col items-center justify-center text-gray-500 group-hover:text-red-600 transition-colors"
            >
              <i data-lucide="box" class="w-6 h-6 mb-1"></i>
              <span class="text-[10px] font-bold uppercase">3D View</span>
            </div>
          </button>

          <!-- Thumbnails de Imagens -->
          <button
            *ngFor="let img of car.images; let i = index"
            (click)="selectImage(i)"
            class="flex-shrink-0 w-24 h-20 rounded-xl overflow-hidden border-2 transition-all relative"
            [class.border-red-600]="!is3DActive && currentImageIndex === i"
            [class.border-transparent]="is3DActive || currentImageIndex !== i"
            [class.opacity-60]="is3DActive || currentImageIndex !== i"
            [class.hover:opacity-100]="true"
          >
            <img [src]="img" class="w-full h-full object-cover" />
          </button>
        </div>

        <!-- Tabs de Informações -->
        <div class="mt-10">
          <div class="flex border-b border-gray-200">
            <button
              *ngFor="let tab of tabs"
              (click)="activeTab = tab.id"
              class="px-6 py-4 text-sm font-bold uppercase tracking-wider border-b-2 transition-colors focus:outline-none"
              [class.border-red-600]="activeTab === tab.id"
              [class.text-red-600]="activeTab === tab.id"
              [class.border-transparent]="activeTab !== tab.id"
              [class.text-gray-500]="activeTab !== tab.id"
              [class.hover:text-gray-800]="activeTab !== tab.id"
            >
              {{ tab.label }}
            </button>
          </div>

          <div
            class="py-8 animate-fade-in bg-white p-8 rounded-b-3xl rounded-tr-3xl shadow-sm border border-t-0 border-gray-200"
          >
            <!-- Tab: Sobre -->
            <div *ngIf="activeTab === 'about'">
              <h3 class="text-xl font-bold mb-4 text-gray-900">Sobre o Veículo</h3>
              <p class="text-gray-600 leading-relaxed mb-6">{{ car.description }}</p>

              <h4 class="text-sm font-bold uppercase tracking-wider text-gray-400 mb-4">
                Destaques
              </h4>
              <ul class="grid grid-cols-1 md:grid-cols-2 gap-3">
                <li
                  *ngFor="let feat of car.highlights"
                  class="flex items-center gap-2 text-gray-700"
                >
                  <i data-lucide="check-circle-2" class="w-4 h-4 text-green-500"></i>
                  {{ feat }}
                </li>
              </ul>
            </div>

            <!-- Tab: Ficha Técnica -->
            <div *ngIf="activeTab === 'specs'">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-y-6 gap-x-12">
                <div
                  *ngFor="let spec of car.specs"
                  class="flex justify-between items-center border-b border-gray-100 pb-2"
                >
                  <span class="text-gray-500 text-sm">{{ spec.label }}</span>
                  <span class="font-bold text-gray-900">{{ spec.value }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- COLUNA DA DIREITA: Informações e CTA -->
      <div class="w-full lg:w-[35%]">
        <div class="sticky top-24 space-y-6">
          <!-- Card Principal -->
          <div
            class="bg-white p-8 rounded-3xl shadow-lg border border-gray-100 relative overflow-hidden"
          >
            <div
              class="absolute top-0 right-0 w-32 h-32 bg-red-50 rounded-bl-full -mr-10 -mt-10 z-0"
            ></div>

            <div class="relative z-10">
              <span
                class="inline-block bg-red-100 text-red-600 text-[10px] font-black uppercase tracking-widest px-3 py-1 rounded-full mb-3"
              >
                {{ car.condition }}
              </span>

              <h1 class="text-3xl font-black text-gray-900 leading-tight mb-1">
                {{ car.brand }} {{ car.model }}
              </h1>
              <p class="text-gray-500 font-medium">{{ car.version }}</p>

              <div class="my-6 flex items-baseline gap-2">
                <span class="text-sm text-gray-400 font-bold uppercase">R$</span>
                <span class="text-5xl font-black text-gray-900 tracking-tighter">{{
                  formatPrice(car.price)
                }}</span>
              </div>

              <!-- Resumo Specs -->
              <div class="grid grid-cols-2 gap-3 mb-8">
                <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl">
                  <div class="bg-white p-2 rounded-lg shadow-sm text-gray-400">
                    <i data-lucide="calendar" class="w-4 h-4"></i>
                  </div>
                  <div class="flex flex-col">
                    <span class="text-[10px] text-gray-400 uppercase font-bold">Ano</span>
                    <span class="text-sm font-bold text-gray-800">{{ car.year }}</span>
                  </div>
                </div>
                <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl">
                  <div class="bg-white p-2 rounded-lg shadow-sm text-gray-400">
                    <i data-lucide="gauge" class="w-4 h-4"></i>
                  </div>
                  <div class="flex flex-col">
                    <span class="text-[10px] text-gray-400 uppercase font-bold">Km</span>
                    <span class="text-sm font-bold text-gray-800">{{ car.mileage }} km</span>
                  </div>
                </div>
                <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl">
                  <div class="bg-white p-2 rounded-lg shadow-sm text-gray-400">
                    <i data-lucide="fuel" class="w-4 h-4"></i>
                  </div>
                  <div class="flex flex-col">
                    <span class="text-[10px] text-gray-400 uppercase font-bold">Combustível</span>
                    <span class="text-sm font-bold text-gray-800">{{ car.fuel }}</span>
                  </div>
                </div>
                <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl">
                  <div class="bg-white p-2 rounded-lg shadow-sm text-gray-400">
                    <i data-lucide="settings-2" class="w-4 h-4"></i>
                  </div>
                  <div class="flex flex-col">
                    <span class="text-[10px] text-gray-400 uppercase font-bold">Câmbio</span>
                    <span class="text-sm font-bold text-gray-800">{{ car.transmission }}</span>
                  </div>
                </div>
              </div>

              <!-- CTAs -->
              <div class="space-y-3">
                <button
                  class="w-full py-4 bg-green-600 hover:bg-green-700 text-white font-bold rounded-xl shadow-lg shadow-green-200 transition-all flex items-center justify-center gap-2 hover:-translate-y-0.5"
                >
                  <i data-lucide="message-circle" class="w-5 h-5"></i>
                  Negociar pelo WhatsApp
                </button>
                <button
                  (click)="openInterestModal()"
                  class="w-full py-4 bg-gray-900 hover:bg-gray-800 text-white font-bold rounded-xl shadow-lg transition-all hover:-translate-y-0.5"
                >
                  Tenho Interesse
                </button>
              </div>
            </div>
          </div>

          <!-- Card Vendedor/Loja -->
          <div
            class="bg-white p-6 rounded-3xl shadow-sm border border-gray-100 flex items-center gap-4"
          >
            <div
              class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center text-red-600"
            >
              <i data-lucide="map-pin" class="w-6 h-6"></i>
            </div>
            <div>
              <p class="text-xs text-gray-400 font-bold uppercase">Veículo disponível em:</p>
              <p class="font-bold text-gray-900">AutoElite Matriz - SP</p>
              <p class="text-sm text-gray-500">Av. Brasil, 1234 - Jardins</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- MODAL DE INTERESSE -->
  <div
    *ngIf="isInterestModalOpen"
    class="fixed inset-0 z-50 flex items-center justify-center p-4 animate-fade-in"
  >
    <!-- Backdrop -->
    <div
      class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity"
      (click)="closeInterestModal()"
    ></div>

    <!-- Modal Content -->
    <div
      class="relative bg-white rounded-3xl shadow-2xl w-full max-w-4xl overflow-hidden flex flex-col md:flex-row max-h-[90vh] md:max-h-[600px] animate-scale-up"
    >
      <!-- Close Button -->
      <button
        (click)="closeInterestModal()"
        class="absolute top-4 right-4 z-10 bg-white/50 hover:bg-white p-2 rounded-full text-gray-800 transition-all"
      >
        <i data-lucide="x" class="w-5 h-5"></i>
      </button>

      <!-- Esquerda: Dados do Carro -->
      <div
        class="w-full md:w-2/5 bg-gray-50 p-8 flex flex-col justify-center border-b md:border-b-0 md:border-r border-gray-100 relative overflow-hidden"
      >
        <!-- Decorative Element -->
        <div class="absolute top-0 left-0 w-full h-2 bg-red-600"></div>

        <img
          [src]="car.images[0]"
          class="w-full h-40 object-cover rounded-xl shadow-md mb-6 transform hover:scale-105 transition-transform duration-500"
        />

        <h3 class="text-2xl font-black text-gray-900 leading-tight mb-1">
          {{ car.brand }} {{ car.model }}
        </h3>
        <p class="text-gray-500 text-sm mb-6 font-medium">{{ car.version }}</p>

        <div
          class="flex flex-col gap-3 mt-auto bg-white p-4 rounded-xl border border-gray-100 shadow-sm"
        >
          <div class="flex justify-between items-center text-sm border-b border-gray-50 pb-2">
            <span class="text-gray-400 font-bold uppercase text-[10px]">Ano</span>
            <span class="font-bold text-gray-900">{{ car.year }}</span>
          </div>
          <div class="flex justify-between items-center text-sm border-b border-gray-50 pb-2">
            <span class="text-gray-400 font-bold uppercase text-[10px]">Quilometragem</span>
            <span class="font-bold text-gray-900">{{ car.mileage }} km</span>
          </div>
          <div class="flex justify-between items-end pt-1">
            <span class="text-gray-400 font-bold uppercase text-[10px]">Preço</span>
            <span class="text-xl font-black text-red-600">{{ formatPrice(car.price) }}</span>
          </div>
        </div>
      </div>

      <!-- Direita: Formulário -->
      <div class="w-full md:w-3/5 p-8 overflow-y-auto custom-scrollbar">
        <h3 class="text-2xl font-black text-gray-900 mb-2">Tenho Interesse</h3>
        <p class="text-gray-500 text-sm mb-6">
          Preencha os dados abaixo e nossa equipe entrará em contato o mais breve possível.
        </p>

        <form [formGroup]="interestForm" (ngSubmit)="onSubmitInterest()" class="space-y-4">
          <div>
            <label class="block text-xs font-bold text-gray-700 uppercase mb-1 ml-1"
              >Nome Completo</label
            >
            <input
              formControlName="name"
              type="text"
              class="w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:border-red-500 focus:ring-1 focus:ring-red-500 transition-all placeholder-gray-400"
              placeholder="Ex: João Silva"
            />
            <p
              *ngIf="interestForm.get('name')?.invalid && interestForm.get('name')?.touched"
              class="text-red-500 text-xs mt-1 ml-1"
            >
              Nome obrigatório
            </p>
          </div>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div>
              <label class="block text-xs font-bold text-gray-700 uppercase mb-1 ml-1"
                >Telefone</label
              >
              <input
                formControlName="phone"
                type="tel"
                class="w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:border-red-500 focus:ring-1 focus:ring-red-500 transition-all placeholder-gray-400"
                placeholder="(00) 00000-0000"
              />
              <p
                *ngIf="interestForm.get('phone')?.invalid && interestForm.get('phone')?.touched"
                class="text-red-500 text-xs mt-1 ml-1"
              >
                Telefone obrigatório
              </p>
            </div>
            <div>
              <label class="block text-xs font-bold text-gray-700 uppercase mb-1 ml-1">Email</label>
              <input
                formControlName="email"
                type="email"
                class="w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:border-red-500 focus:ring-1 focus:ring-red-500 transition-all placeholder-gray-400"
                placeholder="seu@email.com"
              />
              <p
                *ngIf="interestForm.get('email')?.invalid && interestForm.get('email')?.touched"
                class="text-red-500 text-xs mt-1 ml-1"
              >
                Email inválido
              </p>
            </div>
          </div>

          <div>
            <label class="block text-xs font-bold text-gray-700 uppercase mb-1 ml-1"
              >Mensagem (Opcional)</label
            >
            <textarea
              formControlName="message"
              rows="3"
              class="w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:border-red-500 focus:ring-1 focus:ring-red-500 transition-all resize-none placeholder-gray-400"
            ></textarea>
          </div>

          <button
            type="submit"
            [disabled]="interestForm.invalid"
            class="w-full bg-gray-900 hover:bg-red-600 text-white font-bold py-4 rounded-xl shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed mt-4 transform hover:-translate-y-0.5"
          >
            Enviar Proposta
          </button>

          <p class="text-[10px] text-center text-gray-400 mt-2">
            Ao enviar, você concorda com nossa política de privacidade.
          </p>
        </form>
      </div>
    </div>
  </div>
</div>
